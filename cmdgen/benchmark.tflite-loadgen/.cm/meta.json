{
  "accu_init": {
    "ck_env": [
        "--env.CK_LOADGEN_DATASET_SIZE=<<<dataset_size>>>",
        "--env.CK_LOADGEN_BUFFER_SIZE=<<<buffer_size>>>"
    ],
    "deps": [
        "--dep_add_tags.python=v3",
        "--dep_add_tags.mlperf-inference-src=r0.7",
        "--dep_add_tags.compiler=<<<compiler_tags>>>"
    ],
    "record_tags": [
      "mlperf",
      "division.<<<division>>>",
      "task.image-classification",
      "platform.<<<sut>>>",
      "scenario.<<<scenario>>>",
      "mode.<<<mode>>>",
      "workload.<<<model_readable>>>"
    ],
    "record_uoa_parts": [
        "mlperf",
        "<<<division>>>",
        "<<<sut>>>",
        "<<<library>>>",
        "<<<model_readable>>>",
        "<<<scenario>>>",
        "<<<mode>>><<<mode_extension>>>",
        "<<<dataset_size>>>"
    ]
  },
  "build_map": {
    "sut": {
        "mac": {
            "compiler_tags": "llvm,v10"
        },
        "mate10pro": {
            "compiler_tags": "llvm,v6"
        },
        "hikey": {
            "compiler_tags": "gcc,v7"
        },
        "firefly": {
            "compiler_tags": "gcc,v7"
        },
        "xavier": {
            "compiler_tags": "gcc,v7"
        },
        "###": {
            "compiler_tags": "gcc,v8"
        }
    },
    "model": {
        "resnet": {
            "deps": "--dep_add_tags.weights=resnet",
            "division": "closed",
            "model_readable": "###"
        },
        "lite.": {
            "deps": "--dep_add_tags.weights=efficientnet,int8,###",
            "model_readable": "effnet_###"
        },
        "v[123]-.*": {
            "deps": "--dep_add_tags.weights=mobilenet,###",
            "model_readable": "mobilenet_###"
        },
        "edgetpu_.*": {
            "deps": "--dep_add_tags.weights=mobilenet,###",
            "model_readable": "mobilenet_###"
        }
    },
    "preprocessing": {
        "opencv": {
            "deps": "--dep_add_tags.images=crop.875,preprocessed,using-opencv",
            "preprocessed_tag": "preprocessed.opencv"
        },
        "pillow": {
            "deps": "--dep_add_tags.images=crop.875,preprocessed,using-pillow",
            "preprocessed_tag": "preprocessed.pillow"
        }
    },
    "library": {
      "armnn-v19.08-neon": {
        "ck_env": "--env.USE_NEON=1",
        "deps": "--dep_add_tags.library=armnn,v19.08,neon",
        "program_name": "image-classification-armnn-tflite-loadgen",
        "record_tags": [
            "inference_engine.armnn",
            "inference_engine_version.v19.08",
            "inference_engine_backend.neon"
        ]
      },
      "armnn-v19.08-opencl": {
        "ck_env": "--env.USE_OPENCL=1",
        "deps": "--dep_add_tags.library=armnn,v19.08,opencl",
        "program_name": "image-classification-armnn-tflite-loadgen",
        "record_tags": [
            "inference_engine.armnn",
            "inference_engine_version.v19.08",
            "inference_engine_backend.opencl"
        ]
      },
      "tflite-v1.13.1": {
        "deps": "--dep_add_tags.library=tflite,v1.13.1",
        "program_name": "image-classification-tflite-loadgen",
        "record_tags": [
            "inference_engine.tflite",
            "inference_engine_version.v1.13.1"
        ]
      },
      "tflite-v2.2.0-ruy": {
        "deps": "--dep_add_tags.library=tflite,v2.2.0",
        "program_name": "image-classification-tflite-loadgen",
        "record_tags": [
            "inference_engine.tflite",
            "inference_engine_version.v2.2.0",
            "inference_engine_backend.ruy"
        ]
      },
      "tflite-v2.3": {
        "deps": "--dep_add_tags.library=tflite,v2.3.90",
        "program_name": "image-classification-tflite-loadgen",
        "record_tags": [
            "inference_engine.tflite",
            "inference_engine_version.v2.3.0",
            "inference_engine_backend.eigen"
        ]
      },
      "tflite-v2.3-ruy": {
        "deps": "--dep_add_tags.library=tflite,v2.3.90,with.ruy",
        "program_name": "image-classification-tflite-loadgen",
        "record_tags": [
            "inference_engine.tflite",
            "inference_engine_version.v2.3.0",
            "inference_engine_backend.ruy"
        ]
      },
      "tflite-v2.3-xnnpack": {
        "deps": "--dep_add_tags.library=tflite,v2.3.90,with.xnnpack",
        "program_name": "image-classification-tflite-loadgen",
        "record_tags": [
            "inference_engine.tflite",
            "inference_engine_version.v2.3.0",
            "inference_engine_backend.xnnpack"
        ]
      }
    },
    "mode": {
      "accuracy": {
        "ck_env": "--env.CK_LOADGEN_MODE=AccuracyOnly",
        "recommended_dataset_size": "50000",
        "recommended_buffer_size": "500",
        "mode_extension": ".<<<preprocessed_tag>>>",
        "output_file": "accuracy.txt"
      },
      "performance": {
        "ck_env": "--env.CK_LOADGEN_MODE=PerformanceOnly",
        "recommended_dataset_size": "1024",
        "recommended_buffer_size": "1024",
        "mode_extension": "",
        "output_file": "mlperf_log_summary.txt"
      }
    },
    "scenario": {
      "offline": {
        "ck_env": "--env.CK_LOADGEN_SCENARIO=Offline"
      },
      "singlestream": {
        "ck_env": "--env.CK_LOADGEN_SCENARIO=SingleStream"
      }
    },
    "compile": {
      "yes": {
        "shell_wrapped_cmd": "<<<ck_compile_program>>>"
      }
    },
    "no_record": {
      "yes": {
        "shell_wrapped_cmd": "<<<wrapped_ck_run_program>>>"
      }
    },
    "verbose": {
      "yes": {
        "print_output_file": "<<<print_output_file_cmd>>>"
      },
      "all": {
        "screen_output": "",
        "print_output_file": "<<<print_output_file_cmd>>>"
      }
    }

  },
  "cmd_template": "<<<shell_wrapped_cmd>>>",
  "defaults": {
    "shell_wrapped_cmd": "<<<wrapped_ck_benchmark_program>>>",

    "print_output_file_cmd": "&& cat `ck find program:<<<program_name>>>`/tmp/<<<output_file>>>",

    "wrapped_ck_run_program": "<<<ck_run_program>>> <<<?print_output_file>>>",
    "wrapped_ck_benchmark_program": "if [ -n \"`ck list local:experiment:<<<record_uoa>>>`\" ]; then echo 'Experiment <<<record_uoa>>> exists, skipping' ; else <<<ck_benchmark_program>>> \"@@@{'meta': {'ck_benchmark_program': '<<<ck_benchmark_program>>>'}}\" <<<?print_output_file>>> ; fi",

    "ck_compile_program": "ck compile program:<<<program_name>>> <<<?deps >>>",
    "run_or_benchmark_common": "program:<<<program_name>>> <<<screen_output>>> <<<?deps >>> <<<?ck_env >>>",
    "ck_run_program": "ck run <<<run_or_benchmark_common>>>",
    "ck_benchmark_program": "ck benchmark <<<run_or_benchmark_common>>> --skip_stat_analysis --process_multi_keys --repetitions=<<<repetitions>>> --record --record_repo=local --record_uoa=<<<record_uoa>>> --tags=<<<record_tags,>>>",

    "dataset_size": "<<<recommended_dataset_size>>>",
    "buffer_size": "<<<recommended_buffer_size>>>",
    "division": "open",
    "record_uoa": "<<<record_uoa_parts->>>",
    "repetitions": "1",
    "screen_output": "--env.CK_SILENT_MODE=YES --skip_print_timers"
  }
}
